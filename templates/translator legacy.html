<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translator | BABELANGUE</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

    <body class="bg-light text-dark">
        <!-- Navigation Bar -->
        <nav class="navbar navbar-expand-lg bg-white border-bottom shadow-sm">
            <div class="container-fluid">
                <a class="navbar-brand d-flex align-items-center" href="/">
                    <img src="/static/babelangue_logo.png" alt="Logo" width="40" height="40" class="me-2">
                    <span class="fw-bold">BABELANGUE</span>
                </a>
                <div>
                    <a class="btn btn-primary me-2" href="/translator">Translator</a>
                    <a class="btn btn-outline-primary me-2" href="">Trainer</a>
                </div>
            </div>
        </nav>


        <div class="container mt-5">

            <h1 class="mb-4">Translator</h1>

            <!-- Choose Deck -->
            <div class="mb-4">
                <label class="form-label fw-bold">Choose a deck:</label>
                <select class="form-select" id="deckSelect">
                    <option value="" selected disabled>Select a deck</option>
                    {% for deck in decks %}
                    <option value="{{ deck }}">{{ deck }}</option>
                    {% endfor %}
                </select>
            </div>



            <!-- Input text -->
            <div class="mb-4">
                <label class="form-label fw-bold">Text to translate:</label>
                <textarea class="form-control" id="textInput" rows="3" placeholder="Enter text..."></textarea>
            </div>

            <button class="btn btn-primary" onclick="sendTranslation()">Translate</button>

            <!-- Results -->
            <div id="results" class="mt-5"></div>

        </div>

        <script>
            function sendTranslation() {
                const text = document.getElementById("textInput").value;
                const deck = document.getElementById("deckSelect").value;

                if (!text || !deck) {
                    alert("Please enter text and select a deck.");
                    return;
                }

                fetch("/translate_text", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        text: text,
                        deck: deck
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        const resultsDiv = document.getElementById("results");
                        resultsDiv.innerHTML = "";

                        if (data.error) {
                            resultsDiv.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
                            return;
                        }

                        const src = data.source_lang;
                        const translations = data.translations;

                        let html = `<h4>Detected source language: <strong>${src}</strong></h4><hr>`;
                        html += `<h5>Translations:</h5>`;

                        html += `<ul class="list-group">`;

                        for (const lang in translations) {
                            html += `
                <li class="list-group-item d-flex justify-content-between">
                    <span>${lang}</span>
                    <span>${translations[lang]}</span>
                </li>`;
                        }

                        html += "</ul>";

                        resultsDiv.innerHTML = html;
                    });
            }
        </script>

    </body>

</html>